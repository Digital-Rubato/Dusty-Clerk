"""
# Directions and Next Ups

With Gui add:
User inputs -> 
Append inputs to dict ->
Make sure all appended items in dict prints to excel ->

""" 

""" Current Issues: 

None

"""

import pandas as pd

from openpyxl import load_workbook

import PySimpleGUI as sg

""" Data Space """

bc_list = []

table = {}

""" Input Logic 


b_code = input("Input your barcode: ")

bc_list.append(b_code)

t_code = input("Second barcode: ")

bc_list.append(t_code)

# add bc_list as values to dict: table and key: 'p_id'
table['Product ID'] = bc_list

print("Inputs complete. Assembling table.")
print(table)
"""

""" Gui Logic """
#Variable Space

gui_input = sg.InputText()

#layout window

layout = [
	[sg.Text('Dusty Clerk')],
	[sg.Text('Enter your barcode'), gui_input],
	[sg.Button('OK'), sg.Button('Quit')]
	]


#Window Initialization
window = sg.Window('Dusty Clerk', layout)

#While loop to process 'events' and recieve values of the inputs
while True:
	event, values = window.read()
	if event == sg.WIN_CLOSED or event == 'Quit': 
		break
	print('You entered ', values[0])

window.close()


""" Main Excel Logic """

#writing to demo.xslx and using xlsxwriter 'engine'
writer = pd.ExcelWriter('demo.xlsx', engine='xlsxwriter')

print("Adding bulk data")

#dataframe name and age columns
df = pd.DataFrame(table)
print("Bulk Data Added")

#convert DataFrame to excel object
print("Inputting bulk data")

df.to_excel(writer, sheet_name='Sheet1', index=False)

#Saving and writing data
print("Saving")

writer.save()

print("Save Complete")

#read the data to check

print("Playback enabled")

reader = pd.read_excel(r'demo.xlsx')

print(reader)
print("Playback complete")